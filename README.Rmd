---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# mtsta <a href='https://github.com/PaulESantos/mtsta'><img src='man/figures/mtstarl.png' align="right" height="220" width="150" /></a>


<!-- badges: start -->
[![Lifecycle: experimental](https://img.shields.io/badge/lifecycle-experimental-orange.svg)](https://lifecycle.r-lib.org/articles/stages.html)
[![CRAN status](https://www.r-pkg.org/badges/version/mtsta)](https://CRAN.R-project.org/package=mtsta)
[![](http://cranlogs.r-pkg.org/badges/grand-total/mtsta?color=green)](https://cran.r-project.org/package=mtsta)
[![](http://cranlogs.r-pkg.org/badges/last-week/mtsta?color=green)](https://cran.r-project.org/package=mtsta)

<!-- badges: end -->

## Overview
The `mtsta` package provides a powerful tool for searching and matching species names in the montane forests of the Tropical Andes region. It allows users to input a list of species names and find the closest matching names from a curated base data of montane tree species in the region. The matching process takes into account both exact matches and fuzzy matches based on a user-defined maximum distance threshold.

## Installation
You can install the mtsta package from GitHub using the devtools library:

``` r
pak::pak("PaulESantos/mtsta")
```

## Usage
To use the `mtsta` package, simply load it and call the `search_mtsta()` function with your list of species names as the input:

``` r
library(mtsta)

# Example species list
splist <- c("Aphelandra acantasa",
            "Saurauia lehmani",
            "Saurauia bullosaa",
            "Schinus meyerii",
            "Ilex colombiana",
            "Ilex rimbachii",
            "Ilex scopulorum")

result <- search_mtsta(splist, max_distance = 0.1)
print(result)

```

```r
name_submitted              name_matched      accepted_name accepted_family
1 Aphelandra acantasa                                                      
2    Saurauia lehmani Saurauia lehmannii Saurauia lehmannii   Actinidiaceae
3   Saurauia bullosaa   Saurauia bullosa   Saurauia bullosa   Actinidiaceae
4     Schinus meyerii     Schinus meyeri     Schinus meyeri   Anacardiaceae
5     Ilex colombiana    Ilex colombiana    Ilex colombiana   Aquifoliaceae
6      Ilex rimbachii     Ilex rimbachii     Ilex rimbachii   Aquifoliaceae
7     Ilex scopulorum    Ilex scopulorum    Ilex scopulorum   Aquifoliaceae
  accepted_genus           iucn       distribution unsure_distribution     elevation
1                                                                                   
2       Saurauia             NT  Colombia, Ecuador                <NA>  up to 3000 m
3       Saurauia             LC  Colombia, Ecuador                <NA> 1500 – 4000 m
4        Schinus   VU B2ab(iii) Argentina, Bolivia                <NA> 1600 - 2100 m
5           Ilex EN B2ab(iii,v)  Colombia, Ecuador                <NA> 3300 - 3600 m
6           Ilex             NT      Ecuador, Peru                <NA> 2000 - 3000 m
7           Ilex             NT      Ecuador, Peru                <NA> 2000 - 3500 m
```

## Description

The `search_mtsta()` function takes a list of species names (`splist`) and a maximum distance value (`max_distance`) as input. It performs fuzzy matching and exact matching to find the closest matching species names in the curated base data of montane tree species in the Tropical Andes region. The output is a data frame with data for the submitted species name. If no match is found within the specified maximum distance, the result will show `"nill"` for the matched species name.

## Acknowledgments

A team of Regional Red List of Montane Tree Species of the Tropical Andes (2014). The research was carried out by Natalia Tejedor Garavito from Bournemouth University in collaboration with BGCI and over 20 regional experts. Source data [here](https://www.bgci.org/resources/bgci-tools-and-resources/the-regional-red-list-of-montane-tree-species-of-the-tropical-andes/)

The curated base data used in this package was reviewed and validated using the [Taxonomic Name Resolution Service TNRS](https://tnrs.biendata.org/). The TNRS is a computer-assisted tool for standardizing plant scientific names, correcting spelling errors, and resolving out-of-date names to the current accepted names. We are grateful for the contribution of the TNRS in validating the accuracy of the base data.

### Summary of results of this regional Red List report:

```{r summary_1, echo=FALSE}
summ_df <- tibble::tribble(
     ~Conservation.status, ~tag, ~Number.of.species,
  "Critically Endangered", "CR",                 1L,
             "Endangered", "EN",                42L,
             "Vulnerable", "VU",                27L,
        "Near Threatened", "NT",                20L,
          "Least Concern", "LC",                29L,
         "Data Deficient", "DD",                 8L,
          "Not Evaluated", "NE",                 0L
  )

summ_df |> 
  dplyr::select(1,3) |> 
  janitor::adorn_totals() |> 
  knitr::kable()
```

###  Number of endemic tree species by country in the tropical Andes.
(Calderón et al. 2002; IUCN 2010; León-Yánez et al. 2011; León et al. 2006; Llamozas et al. 2003; Meneses and Beck 2005).


```{r summary_2, echo=FALSE, fig.align='center'}
summ_2 <- tibble::tribble(
               ~Country, ~CR,  ~EN,  ~VU, ~NT, ~LC, ~DD, ~Subtotal,  ~NE, ~Total,
              "Ecuador",  2L,  36L,  52L,  9L,  5L,  1L,      105L,  61L,   166L,
                 "Peru",  9L,  31L,  15L,  2L,  3L, 10L,       70L,  50L,   120L,
             "Colombia",  4L,   5L,   5L,  2L,  1L,  0L,       17L,  60L,    77L,
              "Bolivia",  0L,   5L,   1L,  0L,  0L,  1L,        7L,  94L,   101L,
            "Argentina",  0L,   0L,   0L,  0L,  0L,  0L,        0L,   3L,     3L,
            "Venezuela",  0L,   0L,   0L,  0L,  0L,  0L,        0L,   0L,     0L,
        "Total endemic", 15L,  77L,  73L, 13L,  9L, 12L,      199L, 268L,   467L,
  "Regional assessment",  1L,  42L,  27L, 20L, 29L,  8L,      127L,   0L,   127L,
          "Total Andes", 16L, 119L, 100L, 33L, 38L, 20L,      326L, 268L,   594L
  )

summ_2 |> 
  knitr::kable()
```


